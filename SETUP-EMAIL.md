# Настройка отправки email для восстановления пароля в Supabase

Чтобы функция "Забыли пароль?" работала, нужно настроить отправку писем в Supabase.

## Вариант 1: Использовать встроенный Supabase Email (для Production)

1. **Открой Supabase Dashboard**: https://supabase.com/dashboard
2. **Выбери свой проект**
3. **Перейди в:** `Authentication` → `Email Templates`
4. **Проверь шаблон "Reset Password"** — там должна быть ссылка для сброса пароля
5. **Перейди в:** `Authentication` → `Providers` → `Email`
6. **Включи:** "Enable Email provider"
7. **Установи:** "Confirm email" = Disabled (если хочешь, чтобы пользователи могли входить сразу без подтверждения email)

### Важно:
- По умолчанию Supabase отправляет не более **3 писем в час** с одного email (защита от спама)
- Для Production рекомендуется настроить свой SMTP (см. Вариант 2)

---

## Вариант 2: Настроить свой SMTP (рекомендуется для Production)

### Где взять SMTP:
- **Gmail** (бесплатно, но ограничено 500 писем/день)
- **SendGrid** (бесплатно до 100 писем/день)
- **Mailgun** (бесплатно до 5000 писем/месяц)
- **Amazon SES** (очень дешево, надежно)

### Как настроить:

1. **Открой Supabase Dashboard**
2. **Перейди в:** `Project Settings` → `Auth` → `SMTP Settings`
3. **Включи:** "Enable Custom SMTP"
4. **Заполни данные:**
   - **Host**: `smtp.gmail.com` (для Gmail) или хост твоего SMTP
   - **Port**: `587` (TLS) или `465` (SSL)
   - **Username**: твой email или API username
   - **Password**: пароль приложения (для Gmail создается в настройках аккаунта Google)
   - **Sender email**: email, с которого будут отправляться письма
   - **Sender name**: "AI-Биржа" (или как хочешь)

### Для Gmail:
1. Зайди в Google Account → Security → 2-Step Verification
2. Включи "App passwords" (Пароли приложений)
3. Создай пароль для "Mail"
4. Используй этот пароль в Supabase SMTP Settings

---

## Вариант 3: Локальная разработка (InBucket)

Для локального тестирования можно использовать встроенный InBucket (если работаешь через Supabase CLI):

1. Запусти локальный Supabase: `supabase start`
2. Открой InBucket: http://localhost:54324
3. Все письма будут видны здесь (не отправляются реально)

---

## Проверка работы

После настройки:

1. Открой сайт
2. Нажми "Вход/регистрация"
3. Введи свой email
4. Нажми "Забыли пароль?"
5. Проверь почту (включая папку Спам)
6. Перейди по ссылке из письма
7. Введи новый пароль

---

## Текущее состояние

✅ Кнопка "Забыли пароль?" добавлена в:
- Модальное окно на главной странице
- Страницу /auth

✅ Логика восстановления реализована через `sb.auth.resetPasswordForEmail()`

⚠️ Требуется настройка SMTP в Supabase Dashboard для реальной отправки писем

---

## Альтернативное решение (временное)

Если настройка SMTP сейчас не критична, можно:

1. **Восстанавливать пароль вручную** через Supabase Dashboard:
   - `Authentication` → `Users` → найти пользователя → `Send magic link`

2. **Или временно отключить восстановление пароля** и добавить контакт поддержки:
   - Заменить ссылку "Забыли пароль?" на "Свяжитесь с поддержкой: support@example.com"



